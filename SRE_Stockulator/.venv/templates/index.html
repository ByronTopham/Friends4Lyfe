<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stockulator</title>
    <style>
        .container {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
        }

        .form-column {
            width: 30%;
            padding-right: 20px;
        }

        .graph-column {
            width: 65%;
            padding-left: 20px;
        }

        img {
            max-width: 100%;
            height: auto;
        }
    </style>
    <script>
        function updateColorOptions() {
            var color1 = document.getElementById("color1").value;
            var color2 = document.getElementById("color2").value;
            var color1Options = document.getElementById("color1").options;
            var color2Options = document.getElementById("color2").options;

            for (var i = 0; i < color1Options.length; i++) {
                color1Options[i].disabled = false;
                color2Options[i].disabled = false;
            }

            for (var i = 0; i < color1Options.length; i++) {
                if (color1Options[i].value === color2) {
                    color1Options[i].disabled = true;
                }
                if (color2Options[i].value === color1) {
                    color2Options[i].disabled = true;
                }
            }
        }

        window.onload = function() {
            updateColorOptions();
        }
    </script>
</head>
<body>

    <h1>STOCKULATOR</h1>

    <div class="container">
        <div class="form-column">
            <form method="POST">
                <label for="load_config">Load Configuration:</label>
                <select id="load_config" name="load_config">
                    <option value="none">None</option>
                    {% for config in configurations %}
                        <option value="{{ config[0] }}" {% if selected_config and selected_config[1] == config[0] %}selected{% endif %}>{{ config[0] }}</option>
                    {% endfor %}
                </select>
                <button type="submit" name="action" value="load">Load</button><br><br>

                <label for="stockname">Stock Name:</label>
                <input type="text" id="stockname" name="stockname" value="{{ stockname if stockname else 'AAPL' }}"><br><br>

                <label for="start">Start Date:</label>
                <input type="date" id="start" name="start" value="{{ start if start else '2020-01-01' }}"><br><br>

                <label for="end">End Date:</label>
                <input type="date" id="end" name="end" value="{{ end if end else '2023-01-01' }}"><br><br>

                <label for="timestep">Time Step:</label>
                <select id="timestep" name="timestep">
                    <option value="1 day" {% if time_step == '1 day' %}selected{% endif %}>1 Day</option>
                    <option value="1 week" {% if time_step == '1 week' %}selected{% endif %}>1 Week</option>
                </select><br><br>

                <label for="color1">Color for Stock 1:</label>
                <select id="color1" name="color1" onchange="updateColorOptions()">
                    <option value="blue" {% if color1 == 'blue' %}selected{% endif %}>Blue</option>
                    <option value="red" {% if color1 == 'red' %}selected{% endif %}>Red</option>
                    <option value="green" {% if color1 == 'green' %}selected{% endif %}>Green</option>
                    <option value="yellow" {% if color1 == 'yellow' %}selected{% endif %}>Yellow</option>
                    <option value="purple" {% if color1 == 'purple' %}selected{% endif %}>Purple</option>
                    <option value="orange" {% if color1 == 'orange' %}selected{% endif %}>Orange</option>
                    <option value="pink" {% if color1 == 'pink' %}selected{% endif %}>Pink</option>
                </select><br><br>

                <label for="stockname2">Second Stock Name (optional):</label>
                <input type="text" id="stockname2" name="stockname2" value="{{ stockname2 if stockname2 else '' }}"><br><br>

                <label for="color2">Color for Stock 2:</label>
                <select id="color2" name="color2" onchange="updateColorOptions()">
                    <option value="blue" {% if color2 == 'blue' %}selected{% endif %}>Blue</option>
                    <option value="red" {% if color2 == 'red' %}selected{% endif %}>Red</option>
                    <option value="green" {% if color2 == 'green' %}selected{% endif %}>Green</option>
                    <option value="yellow" {% if color2 == 'yellow' %}selected{% endif %}>Yellow</option>
                    <option value="purple" {% if color2 == 'purple' %}selected{% endif %}>Purple</option>
                    <option value="orange" {% if color2 == 'orange' %}selected{% endif %}>Orange</option>
                    <option value="pink" {% if color2 == 'pink' %}selected{% endif %}>Pink</option>
                </select><br><br>

                <label for="bestfit">Add Line of Best Fit:</label>
                <input type="checkbox" id="bestfit" name="bestfit" {% if bestfit_checked %}checked{% endif %}><br><br>

                <!-- Generate button -->
                <button type="submit" name="action" value="generate">Generate</button>

                <!-- Save configuration -->
                <label for="config_name">Save Configuration As:</label>
                <input type="text" id="config_name" name="config_name"><br><br>
                <button type="submit" name="action" value="save">Save Configuration</button>

                <!-- Download configuration -->
                <button type="submit" name="action" value="download">Download Configuration</button>

                <div>
                    {% with messages = get_flashed_messages() %}
                    {% if messages %}
                    <ul>
                        {% for message in messages %}
                        <li>{{ message }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                    {% endwith %}
                </div>
            </form>
        </div>

        <!-- Graph column -->
        <div class="graph-column">
            {% if filename %}
                <img src="{{ url_for('static', filename=filename) }}" alt="Stock Graph">
            {% endif %}
        </div>
    </div>

</body>
</html>
